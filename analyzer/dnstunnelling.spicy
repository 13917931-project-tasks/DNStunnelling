# TODO: Define your analyzer here.

module dnstunnelling;

public type dnstun_unit = unit {
    id: Dns_Id;
    flags: Flags;
    payload: bytes &eod;
    #on %done { print self;} 
    	
} &convert=self.flags.flags_data.to_int();


public type Dns_Id = unit {
    id_data: bytes &size=2;
    #id_data: bytes &until=b"\x00";
    on %done {print "Id's: %s" % self; }
};

public type Flags = unit {
    #b"\x9e";
    flags_data: bytes &size=1;
    on %done { print "Flags: %s" % self; }
};



